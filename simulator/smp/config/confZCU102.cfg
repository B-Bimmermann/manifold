// conf for 4 kernel arm
// processor ->     config = "../config/spx-outorder.a64.config";

simulation_stop = 50e6;
default_clock = 1e9;
qsim_interrupt_handler_clock = 1e3;
kitfox_config = "../config/kitfox-4core.config";
kitfox_freq = 1000;

network:
{
    topology = "TORUS6P";
    x_dimension = 2;
    y_dimension = 2;
    num_vcs = 4;
    credits = 6;
    link_width = 128;

    ni_up_credits = 20; //credits for network interface sending to terminal
    ni_up_buffer = 5; //network interface's output buffer (to terminal) size

    coh_msg_type = 123; //message types
    mem_msg_type = 456;
    credit_msg_type = 789;
};

processor:
{
    type = "SPX";
    node_idx = [0, 1, 2, 3];
    //config = "../config/spx-inorder.a64 .config";
    //config = "../config/spx-outorder.a64.config";
    config = "/home/bimmermann/Masterarbeit/GITHUB-AREX/manifold/simulator/smp/config/spx-inorder.a64.config";

    state = "ZCU102";
    petalinux_path = "/media/bimmermann/petalinux-platte/xilinx-zcu102-2017.3/";
    qemu_shared_folder_path = "/home/bimmermann/Masterarbeit/qemu_shared_folder/";
};

llp_cache:
{
    name = "L1";
    type = "DATA";
    size = 0x8000; //32K     //https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf V.16 S.56
    assoc = 4;               //https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf V.16 S.60
    block_size = 64;         // Unclear maybe it must be 64 ? See code : https://github.com/B-Bimmermann/manifold/blob/zcu102_manifold_dev/models/cache/mcp-cache/hash_table.cpp#L183 -> See http://infocenter.arm.com/help/topic/com.arm.doc.ddi0500d/DDI0500D_cortex_a53_r0p2_trm.pdf S.364
    hit_time = 2;            // See: Computer Organization and Design RISC-V Edition: The Hardware Software Interface von David A. Patterson,John L. Hennessy (ISBN-13: 978-0128122754) S.: 461

    // Can't run:
    replacement_policy = "random"; // See: Computer Organization and Design RISC-V Edition: The Hardware Software Interface von David A. Patterson,John L. Hennessy (ISBN-13: 978-0128122754) S.: 461

    // To check:
    lookup_time = 2;         //  Wait time for the cahe ?!? // minimum must be hit time ... 
    // according to http://impact.crhc.illinois.edu/shared/report/ms-thesis-jim-sicolo.pdf p. 7 MSHRs record data to match incoming missed cache lines from the memory to CPU registers
    // Assumption: https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf V.16 p. 427 indicates that the APU (L2 cache) may request 2x16 = 32 maximum number of outstanding transactions (the two links from CCI to MC are equally shared across all requests)
    // Assumption: Each L1 cache may issue the total number of outstanding L2 cache lines to the L2 cache
    mshr_size = 32;           //  association of the hash table // Maybe this should be 1  // CODE: https://github.com/B-Bimmermann/manifold/blob/zcu102_manifold_dev/models/cache/mcp-cache/L1_cache.cpp#L40

    downstream_credits = 20; //credits for sending to network
};

lls_cache:
{
    name = "L2";
    type = "DATA";
    size = 0x100000 ; //1MB  //https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf V.16 S.61
    assoc = 16;              //https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf V.16 S.61
    block_size = 64;         // Unclear maybe it must be 64 ? See code : https://github.com/B-Bimmermann/manifold/blob/zcu102_manifold_dev/models/cache/mcp-cache/hash_table.cpp#L183
    hit_time = 12;           // See: Computer Organization and Design RISC-V Edition: The Hardware Software Interface von David A. Patterson,John L. Hennessy (ISBN-13: 978-0128122754) S.: 461

    replacement_policy = "LRU"; // See: Computer Organization and Design RISC-V Edition: The Hardware Software Interface von David A. Patterson,John L. Hennessy (ISBN-13: 978-0128122754) S.: 461

    // To check:
    lookup_time = 12;        //  Wait time for the cahe ?!? // minimum must be hit time ... 
    // see above for discussion of this value
    mshr_size = 32;          //  association of the hash table // Maybe this should be 1  // CODE: https://github.com/B-Bimmermann/manifold/blob/zcu102_manifold_dev/models/cache/mcp-cache/L1_cache.cpp#L40


    downstream_credits = 20; //credits for sending to network
};

mc: //memory controller
{
    //node_idx = [0, 1, 2, 3];
    node_idx = [0, 1, 2, 3];
    downstream_credits = 10; //credits for sending to network
    type = "DRAMSIM";

    dramsim2:
    {
        dev_file = "../config/DDR4_micron_512M_8b_x8_pc2133.ini";
        sys_file = "../config/3d_dies_sys_file_zcu_102.ini";
        size = 4096;
    };
};
